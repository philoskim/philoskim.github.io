<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>7&nbsp;core.async</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Clojure Memo</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="why-clojure.html" class="tocviewlink" data-pltdoc="x">Why Clojure?</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="recursions.html" class="tocviewlink" data-pltdoc="x">Recursions</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="functional-patterns.html" class="tocviewlink" data-pltdoc="x">Functional Patterns</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="var.html" class="tocviewlink" data-pltdoc="x">Vars</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="testing.html" class="tocviewlink" data-pltdoc="x">Testing</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="tips.html" class="tocviewlink" data-pltdoc="x">Tips</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">core.async</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="clojurescript.html" class="tocviewlink" data-pltdoc="x">Clojure<span class="mywbr"> &nbsp;</span>Script &#49548;&#44060;</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">6.2</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tips.html" title="backward to &quot;6 Tips&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Clojure Memo&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="clojurescript.html" title="forward to &quot;8 ClojureScript 소개&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>7<tt>&nbsp;</tt><a name="(part._core-async)"></a>core.async</h3><p>Clojure(Script)&#50640; &#44396;&#54788;&#46104;&#50612; &#51080;&#45716; core.async&#45716;, Non-blocking IO &#50857;&#46020;&#47196;&#46020; &#54876;&#50857;&#51060; &#44032;&#45733;&#54616;&#51648;&#47564;,
&#45908; &#51473;&#50836;&#54620; &#50857;&#46020;&#45716;, &#48708;&#46041;&#44592;&#51201;&#51004;&#47196; &#52376;&#47532;&#46104;&#45716; &#44163;&#46308;(&#50416;&#47112;&#46300;&#45208; &#53084;&#48177;&#54632;&#49688;)&#51012;, &#47560;&#52824; &#46041;&#44592;&#49885;
&#54532;&#47196;&#44536;&#47000;&#48141;&#54616;&#46319;&#51060;, &#51088;&#49888;&#51060; &#50896;&#54616;&#45716; &#49692;&#49436;&#45824;&#47196; &#49892;&#54665;&#49884;&#53420; &#49688; &#51080;&#45796;&#45716; &#45936; &#51080;&#45796;.</p><p>&#50696;&#47484; &#46308;&#50612;, &#54616;&#45208;&#51032; &#51068;&#51012; &#52376;&#47532;&#54616;&#45716; &#45936;, &#50416;&#47112;&#46300; A&#44032; &#52376;&#47532;&#54620; &#44208;&#44284;&#47484; &#50416;&#47112;&#46300; B&#44032; &#48155;&#50500;, &#45796;&#49884; &#44536;
&#44208;&#44284;&#47484; &#50416;&#47112;&#46300; C&#50640; &#45336;&#44592;&#45716; &#49885;&#51004;&#47196; &#54532;&#47196;&#44536;&#47000;&#48141; &#54616;&#45716; &#44163;&#51060; &#44032;&#45733;&#54616;&#45796;. (&#50500;&#47000;&#51032; &#44536;&#47548;&#46308;&#50640;&#49436; &#47928;&#51088; A,
B, C, &#46321;&#46321;&#51008; &#44033;&#44033;&#51032; &#50416;&#47112;&#46300; &#54841;&#51008; &#53084;&#48177;&#54632;&#49688;&#47484; &#54364;&#49884;&#54616;&#44256;, &#54868;&#49332;&#54364;&#45716; &#52376;&#47532; &#49692;&#49436;&#47484; &#54364;&#49884;&#54620;&#45796;)</p><p><pre class="descblock">A --&gt; B --&gt; C --&gt; D --&gt; E --&gt; F</pre></p><p>&#45796;&#51020;&#51032; &#44221;&#50864;&#50640;&#49436;&#52376;&#47100;, &#50416;&#47112;&#46300; C&#51032; &#52376;&#47532; &#44208;&#44284;&#50640; &#46384;&#46972; &#50416;&#47112;&#46300; F&#47196; &#44263;&#48148;&#47196; &#51216;&#54532;&#54616;&#45716; &#44163;&#46020;
&#44032;&#45733;&#54616;&#45796;.</p><p><pre class="descblock">A --&gt; B --&gt; C --&gt; D --&gt; E --&gt; F
            |                 ^
            |                 |
            -------------------</pre></p><p>&#45796;&#51020;&#51032; &#44221;&#50864;&#50640;&#49436;&#52376;&#47100;, &#50416;&#47112;&#46300; C&#51032; &#52376;&#47532; &#44208;&#44284;&#50640; &#46384;&#46972; &#45796;&#47480; &#54028;&#51060;&#54532; &#46972;&#51064;&#51012; &#53440;&#45716; &#44163;&#46020; &#44032;&#45733;&#54616;&#45796;.</p><p><pre class="descblock">A --&gt; B --&gt; C --&gt; D --&gt; E --&gt; F
            |
            ----&gt; G --&gt; H --&gt; I</pre></p><p>&#45796;&#51020;&#51032; &#44221;&#50864;&#50640;&#49436;&#52376;&#47100;, &#50416;&#47112;&#46300; D&#51032; &#52376;&#47532; &#44208;&#44284;&#50640; &#46384;&#46972; &#47336;&#54532;&#47484; &#53440;&#45716; &#44163;&#46020; &#44032;&#45733;&#54616;&#45796;.</p><p><pre class="descblock">A --&gt; B --&gt; C --&gt; D --&gt; E --&gt; F
      ^           |
      |           |
      -------------</pre></p><p>&#50948;&#50640;&#49436; &#46304; &#47784;&#46304; &#49324;&#47168;&#47484;, &#49692;&#49688;&#54616;&#44172; &#51088;&#48148;&#49828;&#53356;&#47549;&#53944;&#51032; &#53084;&#48177;&#54632;&#49688; &#49828;&#53440;&#51068;&#47196;&#47564; &#44396;&#54788;&#54616;&#45716; &#44163;&#51008; &#44144;&#51032;
&#48520;&#44032;&#45733;&#54616;&#44144;&#45208;, &#44032;&#45733;&#54616;&#45908;&#46972;&#46020; &#50500;&#51452; &#48373;&#51105;&#54616;&#44172; &#44396;&#54788;&#46112; &#44163;&#51060;&#44256;, &#53084;&#48177;&#54632;&#49688; &#50504;&#50640; &#53084;&#48177; &#54632;&#49688;&#44032; &#51473;&#52393;&#46104;&#45716;
&#48169;&#49885;&#51004;&#47196; &#44396;&#54788;&#54624; &#49688; &#48150;&#50640; &#50630;&#50612;, &#44536; &#53076;&#46300;&#45716; &#51060;&#48120; &#51060;&#54644;&#54616;&#44592; &#50612;&#47140;&#50868; &#44144;&#51032; &#45212;&#51109;&#54032; &#49688;&#51456;&#51060; &#46104;&#50612;
&#51080;&#51012; &#44163;&#51060;&#45796;.</p><p>&#50948;&#50640; &#46304; &#50696;&#46308; &#51473;&#50640;&#49436;, &#46160; &#48264;&#51704; &#44221;&#50864;&#47484; core.async&#47196; &#44396;&#54788;&#54620; &#50696;&#45716; &#45796;&#51020;&#44284; &#44057;&#45796;.</p><p><pre class="codeblock">(ns async.test
  (:refer-clojure :exclude [map reduce into partition
                            partition-by take merge])
  (:require [clojure.core.async :refer :all])

(defn async-sample
  [init]
  (let [ch1 (chan)
        ch2 (chan)
        ch3 (chan)
        ch4 (chan)
        ch5 (chan)
        ch6 (chan)]
    (thread                  ;; thread A
      (let [val (&lt;!! ch1)]
        (println "inside thread A: val =" val)
        (&gt;!! ch2 (+ val 1)) ))

    (thread                  ;; thread B
      (let [val (&lt;!! ch2)]
        (println "inside thread B: val =" val)
        (&gt;!! ch3 (+ val 1)) ))

    (thread                  ;; thread C
      (let [val (&lt;!! ch3)]
        (println "inside thread C: val =" val)
        (if (&lt; val 10)
          (&gt;!! ch4 (+ val 1))
          (&gt;!! ch6 (+ val 100)) )))

    (thread                  ;; thread D
      (let [val (&lt;!! ch4)]
        (println "inside thread D: val =" val)
        (&gt;!! ch5 (+ val 1)) ))

    (thread                  ;; thread E
      (let [val (&lt;!! ch5)]
        (println "inside thread E: val =" val)
        (&gt;!! ch6 (+ val 1)) ))

    (thread                  ;; thread F
      (let [val (&lt;!! ch6)]
        (println "inside thread F: val =" val) ))

    (println "ch1 initialized.")
    (&gt;!! ch1 init) ))


(async-sample 1)
; &gt;&gt; ch1 initialized.
; &gt;&gt; inside thread A: val = 1
; &gt;&gt; inside thread B: val = 2
; &gt;&gt; inside thread C: val = 3
; &gt;&gt; inside thread D: val = 4
; &gt;&gt; inside thread E: val = 5
; &gt;&gt; inside thread F: val = 6

(async-sample 10)
; &gt;&gt; ch1 initialized.
; &gt;&gt; inside thread A: val = 10
; &gt;&gt; inside thread B: val = 11
; &gt;&gt; inside thread C: val = 12
; &gt;&gt; inside thread F: val = 112</pre></p><p>&#45796;&#51020;&#51008; &#50948;&#51032; &#53076;&#46300; &#51060;&#54644;&#47484; &#50948;&#54620; &#50557;&#44036;&#51032; &#49444;&#47749;&#51060;&#45796;.</p><ul><li><p>(chan): &#52292;&#45328;&#51012; &#54616;&#45208; &#49373;&#49457;&#54620;&#45796;.</p></li><li><p>(&gt;!! ch 1): &#52292;&#45328; ch&#50640; 1&#51060;&#46972;&#45716; &#44050;&#51012; &#51665;&#50612; &#45347;&#45716;&#45796;.</p></li><li><p>(&lt;!! ch): &#52292;&#45328; ch&#50640; &#45812;&#44200; &#51080;&#45716; &#44050; &#54620; &#44060;&#47484; &#48764;&#45240;&#45796;. &#52292;&#45328;&#50640; &#50500;&#47924;&#47088; &#44050;&#46020; &#50630;&#51012; &#46412;&#50640;&#45716;
&#49892;&#54665;&#51012; &#47688;&#52628;&#44256;, &#52292;&#45328;&#50640; &#44050;&#51060; &#46308;&#50612; &#50732; &#46468;&#44620;&#51648; &#47924;&#54620;&#51221; &#44592;&#45796;&#47536;&#45796;(&#51060;&#47196; &#51064;&#54644; &#46041;&#44592;&#51201;&#51064;
&#52376;&#47532;&#44032; &#44032;&#45733;&#54644;&#51652;&#45796;).</p></li></ul><p>&#50948;&#51032; &#50696;&#50640;&#49436; &#48380; &#49688; &#51080;&#46319;&#51060;, core.async&#50640;&#49436;&#45716; channel&#51060;&#46972;&#45716; &#51473;&#44228; &#49688;&#45800;&#51012; &#44144;&#52432; &#48708;&#46041;&#44592;&#51201;&#51064;
&#50416;&#47112;&#46300;&#46308;&#44036;&#51032; &#46041;&#44592;&#54868;&#47484; &#51060;&#54984;&#45796;. &#53076;&#46300;&#44032; &#45824;&#45800;&#55176; &#51649;&#44288;&#51201;&#51060;&#44256; &#45800;&#49692;&#54616;&#45796;. &#53364;&#47196;&#51200; &#54532;&#47196;&#44536;&#47000;&#48141;&#51032;
&#54645;&#49900;&#51201;&#51064; &#44032;&#52824;&#51064; '&#45800;&#49692;&#54632;'&#51032; &#52628;&#44396;&#51032; &#44208;&#44284;&#47932;&#51060;&#45796;. &#47924;&#50631;&#48372;&#45796;&#46020; &#53076;&#46300;&#45716; &#44396;&#51312;&#44032; &#45800;&#49692;&#54644;&#50556;
&#54620;&#45796;. &#44536;&#47000;&#50556; &#54532;&#47196;&#44536;&#47000;&#47672;&#44032; &#48260;&#44536;&#47484; &#50577;&#49328;&#54616;&#51648; &#50506;&#44172; &#46108;&#45796;. &#51060;&#44163;&#51012; &#51088;&#48148;&#49828;&#53356;&#47549;&#53944;&#47196; &#44396;&#54788;&#54616;&#47140;&#47732;
&#53084;&#48177; &#54632;&#49688; &#50504;&#50640; &#53084;&#48177; &#54632;&#49688;&#47484; &#50668;&#47084; &#48264; &#51473;&#52393;&#54644;&#50556;&#47564; &#54644;&#49436; &#45824;&#45800;&#55176; &#48373;&#51105;&#54620; &#44396;&#51312;&#51032; &#53076;&#46377;&#51012; &#54644;&#50556;&#47564;
&#54620;&#45796;. callback hell&#51060;&#46972;&#45716; &#47568;&#51060; &#44536;&#45285; &#45208;&#50772;&#44192;&#45716;&#44032;?</p><p>Rich Hickey&#44032; go &#50616;&#50612;&#51032; go block&#51032; &#50689;&#54693;&#51012; &#48155;&#50500; Clojure&#51032; core.async&#47484; &#47676;&#51200; &#44396;&#54788;&#54664;&#44256;, David
Nolen&#51060; &#44536;&#51032; &#46244;&#47484; &#51060;&#50612; ClojureScript&#51032; core.async&#47484; &#44396;&#54788;&#54664;&#45796;(&#52280;&#44256;&#47196;, &#51060; &#46160; &#49324;&#46988;&#51008; &#54788;&#51116;
Cognitect&#46972;&#45716; &#54924;&#49324;&#50640;&#49436; &#54632;&#44760; &#51068;&#54616;&#44256; &#51080;&#50612;, &#49436;&#47196; &#44036;&#50640; &#49884;&#45320;&#51648; &#54952;&#44284;&#47484; &#45244; &#49688; &#51080;&#51004;&#47532;&#46972; &#50668;&#44200;&#51652;&#45796;).</p><p>Clojure&#51032; core.async&#50640; &#51080;&#45716; &#54632;&#49688;&#46308;&#51008; &#53356;&#44172; &#46160; &#51333;&#47448;&#47196; &#45208;&#51540;&#45796;. API &#47928;&#49436;&#47484; &#48372;&#47732; &#50508;&#44192;&#51648;&#47564;,
&#54632;&#49688; &#51060;&#47492; &#46244;&#50640; !!(&#45712;&#45196;&#54364; 2&#44060;)&#44032; &#48537;&#51008; &#44163;&#46308;&#51008; &#50416;&#47112;&#46300; &#50504;&#50640;&#49436;&#47564; &#49324;&#50857;&#54616;&#46972;&#45716; &#44163;&#51060;&#44256;, !(&#45712;&#45196;&#54364;
1&#44060;)&#44032; &#48537;&#51008; &#44163;&#46308;&#51008; go block &#50504;&#50640;&#49436;&#47564; &#49324;&#50857;&#54616;&#46972;&#45716; &#44163;&#51060;&#45796;. ClojureScript&#45716;,
&#51088;&#48148;&#49828;&#53356;&#47549;&#53944;&#49345;&#50640;&#49436; &#46028;&#50500;&#44032;&#48064;&#47196;, &#45817;&#50672;&#55176; &#45800;&#51068; &#50416;&#47112;&#46300; &#49345;&#50640;&#49436;&#47564; &#46028;&#50500;&#44032;&#45716; &#45712;&#45196;&#54364; &#54616;&#45208; &#48537;&#51008;
&#54632;&#49688;&#46308;&#47564; &#49324;&#50857;&#54644;&#50556; &#54620;&#45796;. &#44536;&#47532;&#44256; go block&#51008; &#44221;&#47049; &#50416;&#47112;&#46300;&#46972;&#44256; &#48372;&#47732; &#46104;&#45716;&#45936;, Node.js&#50640;&#49436;&#51032; async
callback &#54632;&#49688;&#47484; &#44396;&#54788;&#54624; &#46412;&#50752; &#47560;&#52268;&#44032;&#51648;&#47196;, &#54616;&#45208;&#51032; &#50416;&#47112;&#46300; &#50504;&#50640;&#49436; &#50668;&#47084; &#44060;&#51032; go block&#51012;
&#44288;&#47532;/&#49688;&#54665;&#54616;&#46020;&#47197; &#44396;&#54788;&#46104;&#50612; &#51080;&#45796;.</p><p>&#50948;&#50640;&#49436; &#46304; &#53076;&#46300;&#47484; &#51088;&#48148;&#49828;&#53356;&#47549;&#53944;&#50640;&#49436; &#49688;&#54665;&#54616;&#47140;&#47732;, &#45796;&#51020;&#44284; &#44057;&#51060; &#53076;&#46300;&#47484; &#50557;&#44036; &#49688;&#51221;&#54644;&#50556; &#54620;&#45796;.</p><p><pre class="codeblock">(ns async.test
  (:refer-clojure :exclude [map filter distinct remove])
  (:require-macros [cljs.core.async.macros :refer [go]])
  (:require [cljs.core.async :refer [&gt;! &lt;! chan put!]]))

;; &#51060; &#54632;&#49688;&#47484; &#54840;&#52636;&#54644;&#50556;, println&#51032; &#52636;&#47141; &#44208;&#44284;&#44032; &#50937; &#48652;&#46972;&#50864;&#51200;&#51032; console &#52285;&#50640;
;; &#51228;&#45824;&#47196; &#52636;&#47141;&#46108;&#45796;.
(enable-console-print!)

(defn async-sample
  [init]
  (let [ch1 (chan)
        ch2 (chan)
        ch3 (chan)
        ch4 (chan)
        ch5 (chan)
        ch6 (chan)
        result 0]
    (go                  ;; go block A
      (let [val (&lt;! ch1)]
        (println "inside go A: val =" val)
        (&gt;! ch2 (+ val 1)) ))

    (go                  ;; go block B
      (let [val (&lt;! ch2)]
        (println "inside go B: val =" val)
        (&gt;! ch3 (+ val 1)) ))

    (go                  ;; go block C
      (let [val (&lt;! ch3)]
        (println "inside go C: val =" val)
        (if (&lt; val 10)
          (&gt;! ch4 (+ val 1))
          (&gt;! ch6 (+ val 100) ))))

    (go                  ;; go block D
      (let [val (&lt;! ch4)]
        (println "inside go D: val =" val)
        (&gt;! ch5 (+ val 1)) ))

    (go                  ;; go block E
      (let [val (&lt;! ch5)]
        (println "inside go E: val =" val)
        (&gt;! ch6 (+ val 1)) ))

    (go                  ;; go block F
      (let [val (&lt;! ch6)]
        (println "inside go F: val =" val) ))

    (println "ch1 initialized.")
    (put! ch1 init) ))</pre></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="tips.html" title="backward to &quot;6 Tips&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Clojure Memo&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="clojurescript.html" title="forward to &quot;8 ClojureScript 소개&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>